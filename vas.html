<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VAS - VALUE ADDED SERVICE</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

    <style>
        @keyframes gradientMove {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        .animated-bg {
            background: linear-gradient(-45deg, #1e293b, #960000, #06b6d4, #4f46e5);
            background-size: 400% 400%;
            animation: gradientMove 10s ease infinite;
        }
        .glass-panel {
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
    </style>
</head>

<body class="animated-bg min-h-screen font-sans text-slate-800">

<header class="glass-panel shadow-lg sticky top-0 z-50">
    <div class="max-w-6xl mx-auto p-4 flex justify-between items-center">
        <h1 class="font-black text-2xl tracking-tighter text-slate-900 uppercase italic">VAS <span class="text-cyan-600">REPORT</span></h1>
        <div class="text-xs font-bold bg-black/10 px-3 py-1 rounded-full tracking-widest uppercase">Live Data</div>
    </div>
</header>

<main class="max-w-6xl mx-auto p-4 lg:p-8">

    <div class="relative max-w-2xl mx-auto mb-10">
        <i class="fa-solid fa-magnifying-glass absolute left-4 top-1/2 -translate-y-1/2 text-slate-400"></i>
        <input id="search" placeholder="Cari data toko atau kategori..."
            class="bg-white/95 w-full p-4 pl-12 rounded-2xl shadow-xl focus:outline-none focus:ring-4 focus:ring-cyan-500/20 transition-all border-none text-lg" />
    </div>

    <div id="content-area" class="space-y-12 pb-20">
        </div>

    <div class="fixed bottom-6 left-1/2 -translate-x-1/2 z-50">
        <button onclick="goBack()" class="px-8 py-3 bg-slate-900 text-white rounded-full font-bold shadow-2xl hover:bg-black hover:-translate-y-1 transition-all active:scale-95 flex items-center gap-2">
            <i class="fa-solid fa-arrow-left"></i> Kembali
        </button>
    </div>

</main>

<script>
const CSV_URL = "https://docs.google.com/spreadsheets/d/1xqkaqEYBEn_j6Mm_cf2u-2kmLpw9x71yALhdC-pFkO8/export?format=tsv";

const sectionConfig = {
    TECPROTEC: { color: "bg-slate-700", border: "border-slate-500", icon: "fa-shield-halved", label: "AR" },
    INDOSAT: { color: "bg-yellow-500", border: "border-yellow-500", icon: "fa-signal", label: "AR" },
    TELKOMSEL: { color: "bg-red-600", border: "border-red-600", icon: "fa-tower-cell", label: " % " }
};

const area = document.getElementById("content-area");

fetch(CSV_URL)
.then(res => res.text())
.then(text => {
    const lines = text.split("\n").map(l => l.trim()).filter(Boolean);
    let mode = "";

    // Build Empty Sections
    Object.keys(sectionConfig).forEach(key => {
        area.innerHTML += `
            <div id="sec-${key}" class="hidden">
                <h2 class="flex items-center gap-3 font-black text-2xl mb-5 text-white drop-shadow-md uppercase italic">
                    <i class="fa-solid ${sectionConfig[key].icon} p-2 bg-white/20 rounded-lg text-sm"></i> ${key}
                </h2>
                <div class="hidden md:block overflow-hidden rounded-2xl shadow-2xl bg-white/60 backdrop-blur-md mb-6">
                    <table class="w-full text-left">
                        <thead>
                            <tr class="${sectionConfig[key].color} text-white text-[10px] uppercase tracking-widest">
                                <th class="p-4">Nama Toko</th>
                                <th class="p-4 text-right">Target</th>
                                <th class="p-4 text-center">Qty</th>
                                <th class="p-4 text-right">Value</th>
                                <th class="p-4 text-right">Tgt/Day</th>
                                <th class="p-4 text-center italic">${sectionConfig[key].label}</th>
                            </tr>
                        </thead>
                        <tbody id="table-${key}" class="divide-y divide-black/5"></tbody>
                    </table>
                </div>
                <div id="mobile-${key}" class="md:hidden grid grid-cols-1 sm:grid-cols-2 gap-4"></div>
            </div>`;
    });

    lines.forEach(line => {
        const cols = line.split("\t");
        const key = cols[0].toUpperCase();

        if (sectionConfig[key]) { 
            mode = key; 
            document.getElementById(`sec-${key}`).classList.remove("hidden");
            return; 
        }
        if (!mode || cols[0].toUpperCase() === "TARGET" || cols.length < 6) return;

        const table = document.getElementById(`table-${mode}`);
        const mobile = document.getElementById(`mobile-${mode}`);
        const arValue = cols[5] || "0";
        
        // Logic warna badge berdasarkan pencapaian
        const isLow = arValue.includes("-") || parseFloat(arValue) < 50;
        const badgeClass = isLow ? "bg-rose-100 text-rose-700" : "bg-cyan-100 text-cyan-700";

        // Desktop Row
        table.innerHTML += `
            <tr class="data-row hover:bg-white/40 transition-colors text-sm">
                <td class="p-4 font-bold text-slate-900">${cols[0]}</td>
                <td class="p-4 text-right font-mono text-xs">${cols[1]}</td>
                <td class="p-4 text-center font-black text-slate-700">${cols[2]}</td>
                <td class="p-4 text-right font-bold text-slate-800">${cols[3]}</td>
                <td class="p-4 text-right text-slate-500 italic text-xs">${cols[4]}</td>
                <td class="p-4 text-center">
                    <span class="px-3 py-1 rounded-lg text-[10px] font-black ${badgeClass}">${arValue}</span>
                </td>
            </tr>`;

        // Mobile Card
        mobile.innerHTML += `
            <div class="mobile-card glass-panel rounded-2xl p-5 shadow-xl border-t-4 ${sectionConfig[mode].border}">
                <div class="flex justify-between items-start mb-4">
                    <div class="font-black text-slate-900 leading-tight pr-4">${cols[0]}</div>
                    <span class="px-2 py-1 rounded text-[10px] font-black ${badgeClass}">${sectionConfig[mode].label}: ${arValue}</span>
                </div>
                <div class="grid grid-cols-2 gap-3 text-[10px]">
                    <div class="bg-black/5 p-2 rounded-xl">
                        <div class="text-slate-400 uppercase font-bold">Target</div>
                        <div class="font-bold">${cols[1]}</div>
                    </div>
                    <div class="bg-black/5 p-2 rounded-xl text-center">
                        <div class="text-slate-400 uppercase font-bold">Qty Sold</div>
                        <div class="font-black text-lg text-slate-700">${cols[2]}</div>
                    </div>
                    <div class="col-span-2 bg-black/5 p-2 px-4 rounded-xl flex justify-between items-center">
                        <span class="text-slate-400 uppercase font-bold italic">Value Achievement</span>
                        <span class="font-black text-slate-800 text-sm">${cols[3]}</span>
                    </div>
                    <div class="col-span-2 text-center text-slate-400 italic text-[9px] pt-1 border-t border-black/5">
                        Target/Day: ${cols[4]}
                    </div>
                </div>
            </div>`;
    });
});

document.getElementById("search").addEventListener("input", function () {
    const keyword = this.value.toLowerCase();
    document.querySelectorAll(".data-row, .mobile-card").forEach(el => {
        el.style.display = el.innerText.toLowerCase().includes(keyword) ? "" : "none";
    });
});

function goBack(){ window.location.href="index.html"; }
</script>

</body>
</html>
